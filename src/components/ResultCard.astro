---
/**
 * Result card component for displaying source detection results.
 * Shows the detected source, confidence score, and recommendation.
 */
---

<output
  id="result-section"
  class="result-section"
  hidden
  aria-live="polite"
  aria-label="Analysis results"
>
  <article class="result-card">
    <header class="result-header">
      <span class="result-icon" id="result-icon" aria-hidden="true"></span>
      <div class="result-titles">
        <h2 class="result-source" id="result-source">Unknown Source</h2>
        <p class="result-medium" id="result-medium">Unknown Medium</p>
      </div>
      <div
        class="confidence-badge"
        id="confidence-badge"
        role="status"
        aria-label="Confidence score"
      >
        <span class="confidence-value" id="confidence-value">0%</span>
        <span class="confidence-label">confidence</span>
      </div>
    </header>

    <div class="result-body">
      <div class="recommendation-section">
        <h3 class="section-title">Enter as Source</h3>
        <div class="recommendation-box" id="recommendation-box">
          <span class="recommendation-text" id="recommendation-text">-</span>
          <button
            type="button"
            class="copy-button"
            id="copy-recommendation"
            aria-label="Copy recommendation to clipboard"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              aria-hidden="true"
            >
              <rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect>
              <path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"
              ></path>
            </svg>
          </button>
        </div>
      </div>

      <div class="paid-indicator" id="paid-indicator" hidden>
        <span class="paid-badge">Paid Traffic</span>
        <p class="paid-description">
          This appears to be paid/advertising traffic based on the detected
          signals.
        </p>
      </div>

      <div class="signals-section" id="signals-section">
        <h3 class="section-title">Detection Signals</h3>
        <ul class="signals-list" id="signals-list">
          <!-- Signals will be populated dynamically -->
        </ul>
      </div>

      <details class="details-section" id="utm-details">
        <summary class="details-summary">View UTM Parameters</summary>
        <div class="utm-table-wrapper">
          <table class="utm-table">
            <tbody id="utm-table-body">
              <!-- UTM parameters will be populated dynamically -->
            </tbody>
          </table>
        </div>
      </details>

      <details class="details-section" id="clickid-details" hidden>
        <summary class="details-summary">View Click IDs</summary>
        <ul class="clickid-list" id="clickid-list">
          <!-- Click IDs will be populated dynamically -->
        </ul>
      </details>
    </div>
  </article>
</output>

<style>
  .result-section {
    margin-top: var(--spacing-3xl);
  }

  .result-section[hidden] {
    display: none;
  }

  .result-card {
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-xl);
    overflow: hidden;
    box-shadow: var(--shadow-md);
    animation: slideUp 0.3s ease forwards;
  }

  @keyframes slideUp {
    from {
      opacity: 0;
      transform: translateY(16px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .result-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
    padding: var(--spacing-lg);
    background-color: var(--color-surface-elevated);
    border-bottom: 1px solid var(--color-border);
  }

  .result-icon {
    font-size: 2.5rem;
    line-height: 1;
  }

  .result-titles {
    flex: 1;
    min-width: 0;
  }

  .result-source {
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
    margin: 0;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .result-medium {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    margin: var(--spacing-xs) 0 0;
  }

  .confidence-badge {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--radius-lg);
    min-width: 80px;
  }

  .confidence-badge.high {
    background-color: var(--color-confidence-high-bg);
    color: var(--color-confidence-high);
  }

  .confidence-badge.medium {
    background-color: var(--color-confidence-medium-bg);
    color: var(--color-confidence-medium);
  }

  .confidence-badge.low {
    background-color: var(--color-confidence-low-bg);
    color: var(--color-confidence-low);
  }

  .confidence-value {
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-bold);
    line-height: 1;
  }

  .confidence-label {
    font-size: var(--font-size-xs);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-top: var(--spacing-xs);
  }

  .result-body {
    padding: var(--spacing-lg);
    display: flex;
    flex-direction: column;
    gap: var(--spacing-lg);
  }

  .section-title {
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    color: var(--color-text-tertiary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin: 0 0 var(--spacing-sm);
  }

  .recommendation-section {
    /* No additional styles needed */
  }

  .recommendation-box {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-md);
    background-color: var(--color-background);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
  }

  .recommendation-text {
    flex: 1;
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
  }

  .copy-button {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-sm);
    background: transparent;
    color: var(--color-text-tertiary);
    border-radius: var(--radius-sm);
  }

  .copy-button:hover {
    color: var(--color-primary);
    background-color: var(--color-surface);
  }

  .copy-button.copied {
    color: var(--color-success);
  }

  .paid-indicator {
    padding: var(--spacing-md);
    background-color: var(--color-warning-bg);
    border-radius: var(--radius-md);
  }

  .paid-indicator[hidden] {
    display: none;
  }

  .paid-badge {
    display: inline-block;
    padding: var(--spacing-xs) var(--spacing-sm);
    background-color: var(--color-warning);
    color: white;
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    border-radius: var(--radius-sm);
  }

  .paid-description {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    margin: var(--spacing-sm) 0 0;
  }

  .signals-section {
    /* No additional styles needed */
  }

  .signals-list {
    list-style: none;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .signals-list li {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-sm);
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
  }

  .signals-list li::before {
    content: "âœ“";
    color: var(--color-success);
    font-weight: var(--font-weight-bold);
  }

  .details-section {
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    overflow: hidden;
  }

  .details-section[hidden] {
    display: none;
  }

  .details-summary {
    padding: var(--spacing-md);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    color: var(--color-text-secondary);
    cursor: pointer;
    background-color: var(--color-background);
    transition: background-color var(--transition-fast);
  }

  .details-summary:hover {
    background-color: var(--color-surface-elevated);
  }

  .utm-table-wrapper {
    padding: var(--spacing-md);
    background-color: var(--color-surface);
  }

  .utm-table {
    width: 100%;
    border-collapse: collapse;
    font-size: var(--font-size-sm);
  }

  .utm-table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--color-border);
  }

  .utm-table tr:last-child td {
    border-bottom: none;
  }

  .utm-table td:first-child {
    font-weight: var(--font-weight-medium);
    color: var(--color-text-tertiary);
    white-space: nowrap;
    width: 120px;
  }

  .utm-table td:last-child {
    font-family: var(--font-family-mono);
    color: var(--color-text-primary);
    word-break: break-all;
  }

  .clickid-list {
    list-style: none;
    padding: var(--spacing-md);
    background-color: var(--color-surface);
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .clickid-list li {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
  }

  .clickid-list li strong {
    color: var(--color-text-primary);
    font-family: var(--font-family-mono);
  }

  @media (min-width: 640px) {
    .result-header {
      padding: var(--spacing-xl);
    }

    .result-body {
      padding: var(--spacing-xl);
    }

    .result-icon {
      font-size: 3rem;
    }

    .result-source {
      font-size: var(--font-size-2xl);
    }
  }
</style>
